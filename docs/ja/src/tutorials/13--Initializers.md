# イニシャライザによるアプリケーション設定のカスタマイズ

イニシャライザは、アプリケーションサイクルの早い段階(ルート、コントローラ、モデルよりも早く)に読み込まれる純粋なJuliaファイルです。それらはアプリケーションのライフサイクルの後半で必要になる可能性がある設定コードを公開するように設計されています。

イニシャライザは`config/initializers/`フォルダ内に配置する必要があり、それらはGenieによって自動的にロード(インクルード)されます。

**設定が環境依存する場合(すなわち、開発と本番環境の間で差異があるデータベース接続)、対応する`config/env/*.jl`ファイルに追加する必要があります。**

## ベストプラクティス

* イニシャライザには好きな名前をつけることができます。(理想を言えば、`redis.jl`のように説明的な名前)
* モジュールを定義しない限り、大文字の名前は使わないでください。(Juliaの命名規則を尊重するため)
* イニシャライザファイルは小さく集中させてください。そうすることでファイルの目的は一つだけになります。
* イニシャライザは必要な数だけ追加することができます。
* イニシャライザを乱用しないでください。それらは複雑なコードをもつことを意図していません。

## ロード順序

イニシャライザはファイルシステムから読まれた順番にロードされます。他のイニシャライザに依存するイニシャライザがある場合、これはモデルまたはライブラリファイルを利用してリファクタリングする必要があることを示唆している可能性があります。

---
**注意喚起**

ライブラリファイルは明確な機能を提供するJuliaファイルで、Genieによって自動的にロードされる`lib/`フォルダに配置することができます。`lib/`フォルダが存在しない場合は、自分でそれを作成することができます。

---

## スコープ

イニシャライザファイルに追加されたすべての定義(変数、定数、関数、モジュールなど)はアプリのモジュールにロードされます。そのため、アプリが`MyGenieApp`という名前の場合、定義は`MyGenieApp`モジュールで利用できます。

---
**注意喚起**

アプリの名前が変数の場合、`UserApp`定数を介してアプリモジュールにアクセスすることができます。そのため、イニシャライザに追加されたすべての定義は、`UserApp`モジュールを介してアクセスすることができます。(`UserApp === MyGenieApp`)

---

## 例

これは、SearchLight ORMをロードするためのGenieのデフォルトイニシャライザです。イニシャライザは、専用の環境依存ファイルで定義されているデータベースの設定情報を含んでいることに注意してください。イニシャライザは、設定のロードとセットアップをSearchLightパッケージに任せるだけです。

```julia
using SearchLight, SearchLight.QueryBuilder

SearchLight.Configuration.load()

if SearchLight.config.db_config_settings["adapter"] !== nothing
  SearchLight.Database.setup_adapter()
  SearchLight.Database.connect()
  SearchLight.load_resources()
end
```
